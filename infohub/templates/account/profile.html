{% extends "base.html" %}

{% block content %}
<div class="container py-5">
  <h2 class="mb-4 text-center">–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>

  <!-- –í–∫–ª–∞–¥–∫–∏ -->
  <ul class="nav nav-tabs mb-4" id="profileTab" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button"
              role="tab" aria-controls="profile" aria-selected="true">
        –ü—Ä–æ—Ñ–∏–ª—å
      </button>
    </li>
    <!-- –î–æ–ø. –≤–∫–ª–∞–¥–∫–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç—É—Ç -->
  </ul>

  <div class="card p-4 mb-4 shadow-sm d-flex flex-row justify-content-between align-items-start flex-wrap" style="gap: 1.5rem;">
    <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
    <div style="flex: 1;">
      <h5>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.username }}!</h5>

      {% if user.first_name or user.last_name %}
        <p>–ò–º—è: {{ user.first_name }} {{ user.last_name }}</p>
      {% endif %}

      <p>Email: {{ user.email }}</p>
      <p>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: {{ user.date_joined|date:"d.m.Y H:i" }}</p>

      {% if user.bio %}
        <p>–û —Å–µ–±–µ: <br> <span class="text-light-emphasis">{{ user.bio }}</span></p>
      {% endif %}

      <p>
        –°—Ç–∞—Ç—É—Å –ø–æ—á—Ç—ã:
        {% if user.email_confirmed %}
          <span class="text-success fw-bold">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞</span>
        {% else %}
          <span class="text-warning fw-bold">‚ö†Ô∏è –ù–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞</span>
          <a href="{% url 'confirm_email' %}" class="btn btn-sm btn-warning ms-2">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</a>
        {% endif %}
      </p>

      <form action="{% url 'delete_account' %}" method="post" onsubmit="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!');">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger mt-3">üóë –£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
      </form>
    </div>

    <div class="d-flex flex-column align-items-center justify-content-center" style="min-width: 140px;">
      {% if user.avatar %}
        <img src="{{ user.avatar.url }}" alt="–ê–≤–∞—Ç–∞—Ä" class="rounded shadow mb-3" style="width: 130px; height: 130px; object-fit: cover;">
      {% else %}
        <div class="text-muted text-center mb-3" style="width: 130px;">–ù–µ—Ç –∞–≤–∞—Ç–∞—Ä–∞</div>
      {% endif %}
      <a href="{% url 'edit_profile' %}" class="btn btn-outline-warning btn-sm w-100">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
    </div>

  </div>

      <h5 class="mb-3">–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∏–≥—Ä—ã:</h5>
      <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle">
          <thead class="table-light">
            <tr>
              <th>#</th>
              <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
              <th>–î–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏</th>
              <th>–û—Ü–µ–Ω–∫–∞</th>
              <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
          </thead>
          <tbody>
            {% for game in user_games %}
              <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ game.title }}</td>
                <td>{{ game.upload_date|date:"d.m.Y" }}</td>
                <td>{{ game.rating|default:"‚Äî" }}</td>
                <td>
                  <a href="{% url 'edit_game' game.id %}" class="btn btn-sm btn-outline-primary">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                  <a href="{% url 'delete_game' game.id %}" class="btn btn-sm btn-outline-danger">–£–¥–∞–ª–∏—Ç—å</a>
                </td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="5" class="text-center">–í—ã –µ—â—ë –Ω–µ –¥–æ–±–∞–≤–∏–ª–∏ –Ω–∏ –æ–¥–Ω–æ–π –∏–≥—Ä—ã.</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}